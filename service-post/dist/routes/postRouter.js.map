{"version":3,"sources":["../../src/routes/postRouter.js"],"names":["express","require","router","Router","get","req","res","personId","headers","posts","Post","aggregate","$match","$project","isLiked","$in","content","tags","likedLength","$size","send","e","console","error","status","json","patch","_id","params","body","updateOne","$push","likes","module","exports"],"mappings":";;AACA;;;;AADA,MAAMA,OAAO,GAAOC,OAAO,CAAC,SAAD,CAA3B;;AAGA,MAAMC,MAAM,GAAQF,OAAO,CAACG,MAAR,EAApB;AAEAD,MAAM,CAACE,GAAP,CAAW,GAAX,EAAgB,OAAOC,GAAP,EAAYC,GAAZ,KAAoB;AAChC,QAAM;AAACC,IAAAA,QAAQ,GAAG;AAAZ,MAA2BF,GAAG,CAACG,OAArC;;AACA,MAAI;AACA,UAAMC,KAAK,GAAK,MAAMC,cAAKC,SAAL,CAAe,CACjC;AAACC,MAAAA,MAAM,EAAE;AAAT,KADiC,EAEjC;AAACC,MAAAA,QAAQ,EAAE;AACHC,QAAAA,OAAO,EAAE;AAACC,UAAAA,GAAG,EAAE,CAACR,QAAD,EAAW,QAAX;AAAN,SADN;AAEHS,QAAAA,OAAO,EAAE,UAFN;AAGHT,QAAAA,QAAQ,EAAE,WAHP;AAIHU,QAAAA,IAAI,EAAE,OAJH;AAKHC,QAAAA,WAAW,EAAE;AAACC,UAAAA,KAAK,EAAE;AAAR;AALV;AAAX,KAFiC,CAAf,CAAtB;AAUAb,IAAAA,GAAG,CAACc,IAAJ,CAASX,KAAT;AACH,GAZD,CAYE,OAAOY,CAAP,EAAU;AACRC,IAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACAf,IAAAA,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB;AACH;AACJ,CAlBD;AAoBAvB,MAAM,CAACwB,KAAP,CAAa,YAAb,EAA2B,OAAOrB,GAAP,EAAYC,GAAZ,KAAoB;AAC3C,QAAM;AAACqB,IAAAA;AAAD,MAAWtB,GAAG,CAACuB,MAArB;AACA,QAAM;AAACrB,IAAAA;AAAD,MAAkBF,GAAG,CAACwB,IAA5B;;AACA,MAAI;AACA,UAAMpB,KAAK,GAAK,MAAMC,cAAKoB,SAAL,CAAe;AAACH,MAAAA;AAAD,KAAf,EAAsB;AAACI,MAAAA,KAAK,EAAE;AAACC,QAAAA,KAAK,EAAEzB;AAAR;AAAR,KAAtB,CAAtB;AACAD,IAAAA,GAAG,CAACc,IAAJ,CAASX,KAAT;AACH,GAHD,CAGE,OAAOY,CAAP,EAAU;AACRC,IAAAA,OAAO,CAACC,KAAR,CAAcF,CAAd;AACAf,IAAAA,GAAG,CAACkB,MAAJ,CAAW,GAAX,EAAgBC,IAAhB;AACH;AACJ,CAVD;AAYAQ,MAAM,CAACC,OAAP,GAAoBhC,MAApB","sourcesContent":["const express   =   require('express');\r\nimport Post from '../models/post';\r\n\r\nconst router    =   express.Router();\r\n\r\nrouter.get('/', async (req, res) => {\r\n    const {personId = 'A12b'}    =   req.headers;\r\n    try {\r\n        const posts =   await Post.aggregate([\r\n            {$match: {}},\r\n            {$project: {\r\n                    isLiked: {$in: [personId, '$likes']},\r\n                    content: \"$content\",\r\n                    personId: \"$personId\",\r\n                    tags: \"$tags\",\r\n                    likedLength: {$size: '$likes'}}\r\n            }]);\r\n\r\n        res.send(posts)\r\n    } catch (e) {\r\n        console.error(e);\r\n        res.status(500).json();\r\n    }\r\n});\r\n\r\nrouter.patch('/like/:_id', async (req, res) => {\r\n    const {_id}  =   req.params;\r\n    const {personId}    =   req.body;\r\n    try {\r\n        const posts =   await Post.updateOne({_id}, {$push: {likes: personId}});\r\n        res.send(posts)\r\n    } catch (e) {\r\n        console.error(e);\r\n        res.status(500).json();\r\n    }\r\n});\r\n\r\nmodule.exports  =   router;"],"file":"postRouter.js"}